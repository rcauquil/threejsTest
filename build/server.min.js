var express=require("express");var app=express();var http=require("http").Server(app);var io=require("socket.io")(http);app.use(express.static(__dirname+"/app"));var USERS={};io.on("connection",function(socket){io.to(socket.id).emit("initPlayer");socket.on("initUsers",function(){io.to(socket.id).emit("initUsers",USERS)});socket.on("addUser",function(user){USERS[user.name]=user;socket.broadcast.emit("newUser",USERS[user.name])});socket.on("movePlayer",function(name,keys,sequence){var posX=50*.015;var posY=50*.015;posX=(keys["37"]?-posX:0)+(keys["39"]?posX:0);posY=(keys["38"]?posY:0)+(keys["40"]?-posY:0);USERS[name].position.x+=posX;USERS[name].position.y+=posY;USERS[name].sequences.push(sequence);io.to(name).emit("movePlayer",name,USERS[name].position,sequence);USERS[name].sequences.shift()});setInterval(function(){io.emit("setPosition",USERS)},100);console.log("user "+socket.id+" connected");socket.on("disconnect",function(){socket.broadcast.emit("deletePlayer",socket.id);delete USERS[socket.id];console.log("user "+socket.id+" disconnected")})});http.listen(3e3,function(){console.log("listening on *:3000")});
//# sourceMappingURL=./build/server.min.js.map